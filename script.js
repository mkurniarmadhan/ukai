// const mikosis = [
  
//   // {
//   //   question: "DO YOU LOVE ME ?",
//   //   optionA: "YA",
//   //   optionB:"YA",
//   //   optionC: "YA",
//   //   optionD: "YA",
//   //   correctOption: "optionC",
//   // },
//   // {
//   //   question:
//   //     "Obat golongan apa yang paling sering digunakan sebagai lini pertama terapi hipertensi?",
//   //   optionA: "NSAID",
//   //   optionB: "Antibiotik",
//   //   optionC: "Antasida",
//   //   optionD: "ACE Inhibitor",
//   //   correctOption: "optionD",
//   // },

//   // {
//   //   question:
//   //     "Manakah dari obat berikut ini termasuk golongan calcium channel blocker?",
//   //   optionA: "Amlodipin",
//   //   optionB: "Captopril",
//   //   optionC: "Losartan",
//   //   optionD: "Furosemid",
//   //   correctOption: "optionA",
//   // },

//   // {
//   //   question:
//   //     "Efek samping yang paling umum dari penggunaan ACE inhibitor seperti captopril adalah?",
//   //   optionA: "Diare",
//   //   optionB: "Batuk kering",
//   //   optionC: "Penglihatan kabur",
//   //   optionD: "Insomnia",
//   //   correctOption: "optionB",
//   // },

//   // {
//   //   question: "Berikut ini adalah faktor risiko utama hipertensi, KECUALI?",
//   //   optionA: "Usia lanjut",
//   //   optionB: "Diet tinggi garam",
//   //   optionC: "Aktivitas fisik teratur",
//   //   optionD: "Riwayat keluarga hipertensi",
//   //   correctOption: "optionC",
//   // },

//   // {
//   //   question:
//   //     "Apa target tekanan darah yang direkomendasikan untuk pasien hipertensi tanpa komorbid menurut JNC 8?",
//   //   optionA: "< 120/80 mmHg",
//   //   optionB: "< 130/80 mmHg",
//   //   optionC: "< 140/90 mmHg",
//   //   optionD: "< 150/100 mmHg",
//   //   correctOption: "optionC",
//   // },

//   // {
//   //   question:
//   //     "Pasien dengan hipertensi dan diabetes sebaiknya diobati dengan target tekanan darah di bawah?",
//   //   optionA: "160/100 mmHg",
//   //   optionB: "150/90 mmHg",
//   //   optionC: "140/90 mmHg",
//   //   optionD: "130/80 mmHg",
//   //   correctOption: "optionD",
//   // },

//   // {
//   //   question:
//   //     "Obat manakah yang termasuk dalam golongan angiotensin receptor blocker (ARB)?",
//   //   optionA: "Nifedipin",
//   //   optionB: "Captopril",
//   //   optionC: "Losartan",
//   //   optionD: "Bisoprolol",
//   //   correctOption: "optionC",
//   // },

//   // {
//   //   question:
//   //     "Hipertensi sekunder dapat disebabkan oleh kondisi berikut, KECUALI?",
//   //   optionA: "Penyakit ginjal",
//   //   optionB: "Penyempitan arteri renalis",
//   //   optionC: "Pheochromocytoma",
//   //   optionD: "Kelelahan akibat olahraga",
//   //   correctOption: "optionD",
//   // },

//   // {
//   //   question:
//   //     "Manakah di bawah ini yang merupakan perubahan gaya hidup yang direkomendasikan untuk pasien hipertensi?",
//   //   optionA: "Menghindari buah dan sayur",
//   //   optionB: "Mengonsumsi garam berlebih",
//   //   optionC: "Berhenti merokok",
//   //   optionD: "Tidur lebih dari 12 jam/hari",
//   //   correctOption: "optionC",
//   // }
// ];

const questions=
  [
    {
      question: "Pasien ditemukan tidak sadar dengan depresi napas, miosis, dan riwayat penggunaan heroin. Apa antidotum yang sesuai?",
      optionA: "Flumazenil",
      optionB: "Atropin",
      optionC: "Nalokson",
      optionD: "N-asetilsistein",
      correctOption: "optionC"
    },
    {
      question: "Seorang pasien overdosis paracetamol, datang 4 jam setelah konsumsi. Antidotum pilihan adalah:",
      optionA: "Vitamin K",
      optionB: "N-asetilsistein",
      optionC: "Fomepizole",
      optionD: "Flumazenil",
      correctOption: "optionB"
    },
    {
      question: "Pasien dengan overdosis warfarin mengalami perdarahan aktif. Apa terapi yang paling tepat?",
      optionA: "Protamin sulfat",
      optionB: "Vitamin B6",
      optionC: "Vitamin K",
      optionD: "Atropin",
      correctOption: "optionC"
    },
    {
      question: "Flumazenil adalah antidotum yang bekerja sebagai antagonis pada reseptor:",
      optionA: "Muskarinik",
      optionB: "Benzodiazepin",
      optionC: "Opioid",
      optionD: "Histamin",
      correctOption: "optionB"
    },
    {
      question: "Pasien keracunan metanol, terapi paling efektif untuk mencegah toksisitas adalah:",
      optionA: "Arang aktif",
      optionB: "Vitamin K",
      optionC: "Fomepizole",
      optionD: "Piridoksin",
      correctOption: "optionC"
    }
  , {
    question: "Seorang petani mengalami kejang, hipersalivasi, dan pupil yang sangat kecil setelah menyemprot pestisida. Terapi pertama yang harus diberikan adalah:",
    optionA: "Flumazenil",
    optionB: "N-asetilsistein",
    optionC: "Atropin",
    optionD: "Vitamin K",
    correctOption: "optionC"
  },
  {
    question: "Pasien mengalami keracunan digoksin dengan aritmia ventrikel. Antidotum spesifik yang digunakan adalah:",
    optionA: "Fomepizole",
    optionB: "Digibind",
    optionC: "Flumazenil",
    optionD: "Atropin",
    correctOption: "optionB"
  },
  {
    question: "Seorang anak minum cairan pembersih yang mengandung etilen glikol. Terapi paling tepat adalah:",
    optionA: "N-asetilsistein",
    optionB: "Etanol atau Fomepizole",
    optionC: "Vitamin K",
    optionD: "Nalokson",
    correctOption: "optionB"
  },
  {
    question: "Pasien dengan overdosis isoniazid datang dengan kejang refrakter. Apa antidotum pilihan?",
    optionA: "Piridoksin",
    optionB: "Vitamin C",
    optionC: "Atropin",
    optionD: "Fomepizole",
    correctOption: "optionA"
  },
  {
    question: "Antidotum yang digunakan untuk keracunan logam berat seperti timbal adalah:",
    optionA: "Nalokson",
    optionB: "Dimercaprol atau EDTA",
    optionC: "Vitamin B6",
    optionD: "Flumazenil",
    correctOption: "optionB"
  },
  {
    question: "Antidotum Protamin sulfat digunakan untuk mengatasi efek dari:",
    optionA: "Warfarin",
    optionB: "Heparin",
    optionC: "Timbal",
    optionD: "Opioid",
    correctOption: "optionB"
  },
  {
    question: "Pasien dengan riwayat bunuh diri minum cairan pemutih. Penanganan awal yang paling tepat adalah:",
    optionA: "Induksi muntah",
    optionB: "Pemberian arang aktif",
    optionC: "Dekontaminasi kulit",
    optionD: "Tidak memberi arang aktif dan observasi saluran cerna",
    correctOption: "optionD"
  },
  {
    question: "Pemberian flumazenil sebagai antidotum harus hati-hati karena risiko:",
    optionA: "Syok anafilaksis",
    optionB: "Aritmia jantung",
    optionC: "Kejang pada pasien dengan adiksi benzodiazepin",
    optionD: "Hipertermia",
    correctOption: "optionC"
  },
  {
    question: "Keracunan karbon monoksida memerlukan terapi berupa:",
    optionA: "N-asetilsistein",
    optionB: "100% Oksigen atau oksigen hiperbarik",
    optionC: "Vitamin K",
    optionD: "Etanol",
    correctOption: "optionB"
  },
  {
    question: "Seorang pria ditemukan dengan napas berbau seperti alkohol dan asidosis metabolik. Kecurigaan utama adalah keracunan:",
    optionA: "Paracetamol",
    optionB: "Opioid",
    optionC: "Metanol",
    optionD: "Benzodiazepin",
    correctOption: "optionC"
  },
  {
    question: "Seorang pasien mengalami keracunan sianida. Antidotum yang digunakan adalah:",
    optionA: "Fomepizole",
    optionB: "Oksigen hiperbarik",
    optionC: "Natrium nitrit + natrium tiosulfat",
    optionD: "Vitamin B6",
    correctOption: "optionC"
  },
  {
    question: "Arang aktif paling efektif diberikan dalam waktu:",
    optionA: "24 jam setelah konsumsi racun",
    optionB: "Setelah timbul gejala",
    optionC: "1 jam pertama setelah paparan",
    optionD: "Setelah muntah dihentikan",
    correctOption: "optionC"
  },
  {
    question: "Pemberian Vitamin K sebagai antidotum dapat digunakan dalam kasus keracunan:",
    optionA: "Aspirin",
    optionB: "Warfarin",
    optionC: "Heparin",
    optionD: "Paracetamol",
    correctOption: "optionB"
  },
  {
    question: "Pasien overdosis heparin mengalami perdarahan aktif. Antidotum paling tepat adalah:",
    optionA: "Vitamin K",
    optionB: "Protamin sulfat",
    optionC: "Atropin",
    optionD: "Flumazenil",
    correctOption: "optionB"
  },
  {
    question: "Apa fungsi dari pralidoksim pada keracunan insektisida organofosfat?",
    optionA: "Menghambat ACh",
    optionB: "Menghambat GABA",
    optionC: "Regenerasi enzim AChE",
    optionD: "Meningkatkan ekskresi ginjal",
    correctOption: "optionC"
  }
  
]

// const  hiperlipid = [
//   {
//     question: "Manakah obat yang paling efektif untuk menurunkan kadar LDL?",
//     optionA: "Niacin",
//     optionB: "Statin",
//     optionC: "Fibrat",
//     optionD: "Omega-3",
//     correctOption: "optionB",
//   },
//   {
//     question: "Obat pilihan pertama untuk pasien dengan risiko kardiovaskular tinggi dan LDL > 130 mg/dL adalah:",
//     optionA: "Gemfibrozil",
//     optionB: "Ezetimibe",
//     optionC: "Atorvastatin",
//     optionD: "Omega-3",
//     correctOption: "optionC",
//   },
//   {
//     question: "Apa mekanisme kerja statin?",
//     optionA: "Menghambat enzim HMG-CoA reductase",
//     optionB: "Menghambat lipase pankreas",
//     optionC: "Mengaktifkan PPAR-gamma",
//     optionD: "Meningkatkan reabsorpsi kolesterol di usus",
//     correctOption: "optionA",
//   },
//   {
//     question: "Efek samping utama dari statin yang perlu dimonitor adalah:",
//     optionA: "Hipokalemia",
//     optionB: "Miopati",
//     optionC: "Gingivitis",
//     optionD: "Hipoglikemia",
//     correctOption: "optionB",
//   },
//   {
//     question: "Manakah kombinasi obat yang meningkatkan risiko rhabdomiolisis?",
//     optionA: "Statin + Niacin",
//     optionB: "Statin + Fibrat",
//     optionC: "Statin + Ezetimibe",
//     optionD: "Statin + Omega-3",
//     correctOption: "optionB",
//   },
//   {
//     question: "Obat yang paling tepat untuk pasien dengan kadar trigliserida > 500 mg/dL adalah:",
//     optionA: "Statin",
//     optionB: "Niacin",
//     optionC: "Fibrat",
//     optionD: "Ezetimibe",
//     correctOption: "optionC",
//   },
//   {
//     question: "Niacin dapat menyebabkan efek samping berupa:",
//     optionA: "Flushing wajah",
//     optionB: "Konstipasi",
//     optionC: "Peningkatan tekanan darah",
//     optionD: "Hiperkalemia",
//     correctOption: "optionA",
//   },
//   {
//     question: "Pasien datang dengan keluhan nyeri otot hebat setelah menggunakan simvastatin dan gemfibrozil. Kemungkinan komplikasi yang terjadi adalah:",
//     optionA: "Pankreatitis",
//     optionB: "Rhabdomiolisis",
//     optionC: "Hipotiroid",
//     optionD: "Hepatitis akut",
//     correctOption: "optionB",
//   },
//   {
//     question: "Ezetimibe bekerja dengan mekanisme:",
//     optionA: "Inhibitor absorpsi kolesterol di usus halus",
//     optionB: "Stimulasi metabolisme lipid di hati",
//     optionC: "Blokade reseptor LDL",
//     optionD: "Inhibitor lipase jaringan adiposa",
//     correctOption: "optionA",
//   },
//   {
//     question: "Manakah di bawah ini yang merupakan efek utama dari fibrat?",
//     optionA: "Menurunkan LDL secara signifikan",
//     optionB: "Meningkatkan HDL dan menurunkan trigliserida",
//     optionC: "Menurunkan tekanan darah",
//     optionD: "Meningkatkan ekskresi asam empedu",
//     correctOption: "optionB",
//   },
//   {
//     question: "Pasien dengan hiperlipidemia dan gagal hati berat, obat berikut sebaiknya dihindari:",
//     optionA: "Omega-3",
//     optionB: "Statin",
//     optionC: "Fibrat",
//     optionD: "Niacin",
//     correctOption: "optionB",
//   },
//   {
//     question: "Kapan pemeriksaan profil lipid ulang dilakukan setelah memulai terapi statin?",
//     optionA: "1 minggu",
//     optionB: "2 minggu",
//     optionC: "4-6 minggu",
//     optionD: "3 bulan",
//     correctOption: "optionC",
//   },
//   {
//     question: "Manakah perubahan gaya hidup yang direkomendasikan untuk pasien hiperlipidemia?",
//     optionA: "Mengonsumsi lemak trans",
//     optionB: "Berolahraga 150 menit/minggu",
//     optionC: "Berhenti konsumsi serat",
//     optionD: "Menghindari aktivitas fisik",
//     correctOption: "optionB",
//   },
//   {
//     question: "Pasien dengan LDL 190 mg/dL tanpa penyakit lain. Apa terapi awal?",
//     optionA: "Diet saja",
//     optionB: "Fibrat",
//     optionC: "Statin intensif",
//     optionD: "Niacin",
//     correctOption: "optionC",
//   },
//   {
//     question: "Obat penurun lipid yang dapat menyebabkan batu empedu adalah:",
//     optionA: "Statin",
//     optionB: "Fibrat",
//     optionC: "Niacin",
//     optionD: "Ezetimibe",
//     correctOption: "optionB",
//   },
//   {
//     question: "Pasien dengan trigliserida 700 mg/dL dan konsumsi alkohol berat. Terapi awal yang tepat adalah:",
//     optionA: "Statin",
//     optionB: "Niacin",
//     optionC: "Fibrat + modifikasi gaya hidup",
//     optionD: "Ezetimibe",
//     correctOption: "optionC",
//   },
//   {
//     question: "Obat yang paling tepat ditambahkan jika statin tidak cukup menurunkan LDL adalah:",
//     optionA: "Omega-3",
//     optionB: "Niacin",
//     optionC: "Ezetimibe",
//     optionD: "Gemfibrozil",
//     correctOption: "optionC",
//   },
//   {
//     question: "Statin tidak boleh diberikan bersamaan dengan gemfibrozil karena:",
//     optionA: "Mengurangi efektivitas statin",
//     optionB: "Meningkatkan risiko hepatotoksisitas",
//     optionC: "Meningkatkan risiko rhabdomiolisis",
//     optionD: "Menurunkan HDL secara drastis",
//     correctOption: "optionC",
//   },
//   {
//     question: "Efek dari omega-3 terhadap lipid adalah:",
//     optionA: "Meningkatkan LDL dan HDL",
//     optionB: "Menurunkan LDL",
//     optionC: "Menurunkan trigliserida",
//     optionD: "Tidak mempengaruhi profil lipid",
//     correctOption: "optionC",
//   },
//   {
//     question: "Manakah indikasi pemberian statin intensif berdasarkan pedoman?",
//     optionA: "LDL 90 mg/dL + usia muda",
//     optionB: "LDL 120 mg/dL tanpa risiko",
//     optionC: "LDL > 190 mg/dL atau DM usia > 40",
//     optionD: "HDL rendah tanpa faktor risiko",
//     correctOption: "optionC",
//   },
// ];

let shuffledQuestions = []; //empty array to hold shuffled selected questions out of all available questions

function handleQuestions() {
  //function to shuffle and push 10 questions to shuffledQuestions array
  //app would be dealing with 10questions per session
  while (shuffledQuestions.length <= 9) {
    const random = questions[Math.floor(Math.random() * questions.length)];
    if (!shuffledQuestions.includes(random)) {
      shuffledQuestions.push(random);
    }
  }
}

let questionNumber = 1; //holds the current question number
let playerScore = 0; //holds the player score
let wrongAttempt = 0; //amount of wrong answers picked by player
let indexNumber = 0; //will be used in displaying next question

// function for displaying next question in the array to dom
//also handles displaying players and quiz information to dom
function NextQuestion(index) {
  handleQuestions();
  const currentQuestion = shuffledQuestions[index];
  document.getElementById("question-number").innerHTML = questionNumber;
  document.getElementById("player-score").innerHTML = playerScore;
  document.getElementById("display-question").innerHTML =
    currentQuestion.question;
  document.getElementById("option-one-label").innerHTML =
    currentQuestion.optionA;
  document.getElementById("option-two-label").innerHTML =
    currentQuestion.optionB;
  document.getElementById("option-three-label").innerHTML =
    currentQuestion.optionC;
  document.getElementById("option-four-label").innerHTML =
    currentQuestion.optionD;
}

function checkForAnswer() {
  const currentQuestion = shuffledQuestions[indexNumber]; //gets current Question
  const currentQuestionAnswer = currentQuestion.correctOption; //gets current Question's answer
  const options = document.getElementsByName("option"); //gets all elements in dom with name of 'option' (in this the radio inputs)
  let correctOption = null;

  options.forEach((option) => {
    if (option.value === currentQuestionAnswer) {
      //get's correct's radio input with correct answer
      correctOption = option.labels[0].id;
    }
  });

  //checking to make sure a radio input has been checked or an option being chosen
  if (
    options[0].checked === false &&
    options[1].checked === false &&
    options[2].checked === false &&
    options[3].checked == false
  ) {
    document.getElementById("option-modal").style.display = "flex";
  }

  //checking if checked radio button is same as answer
  options.forEach((option) => {
    if (option.checked === true && option.value === currentQuestionAnswer) {
      document.getElementById(correctOption).style.backgroundColor = "green";
      playerScore++; //adding to player's score
      indexNumber++; //adding 1 to index so has to display next question..
      //set to delay question number till when next question loads
      setTimeout(() => {
        questionNumber++;
      }, 1000);
    } else if (option.checked && option.value !== currentQuestionAnswer) {
      const wrongLabelId = option.labels[0].id;
      document.getElementById(wrongLabelId).style.backgroundColor = "red";
      document.getElementById(correctOption).style.backgroundColor = "green";
      wrongAttempt++; //adds 1 to wrong attempts
      indexNumber++;
      //set to delay question number till when next question loads
      setTimeout(() => {
        questionNumber++;
      }, 1000);
    }
  });
}

//called when the next button is called
function handleNextQuestion() {
  checkForAnswer(); //check if player picked right or wrong option
  unCheckRadioButtons();
  //delays next question displaying for a second just for some effects so questions don't rush in on player
  setTimeout(() => {
    if (indexNumber <= 9) {
      //displays next question as long as index number isn't greater than 9, remember index number starts from 0, so index 9 is question 10
      NextQuestion(indexNumber);
    } else {
      handleEndGame(); //ends game if index number greater than 9 meaning we're already at the 10th question
    }
    resetOptionBackground();
  }, 1000);
}

//sets options background back to null after display the right/wrong colors
function resetOptionBackground() {
  const options = document.getElementsByName("option");
  options.forEach((option) => {
    document.getElementById(option.labels[0].id).style.backgroundColor = "";
  });
}

// unchecking all radio buttons for next question(can be done with map or foreach loop also)
function unCheckRadioButtons() {
  const options = document.getElementsByName("option");
  for (let i = 0; i < options.length; i++) {
    options[i].checked = false;
  }
}

// function for when all questions being answered
function handleEndGame() {
  let remark = null;
  let remarkColor = null;

  // condition check for player remark and remark color
  if (playerScore <= 3) {
    remark = "SEMANGAT AYANG";
    remarkColor = "red";
  } else if (playerScore >= 4 && playerScore < 7) {
    remark = "AYANG PASTI BISA.";
    remarkColor = "orange";
  } else if (playerScore >= 7) {
    remark = "BISA YOKK";
    remarkColor = "green";
  }
  const playerGrade = (playerScore / 10) * 100;

  //data to display to score board
  document.getElementById("remarks").innerHTML = remark;
  document.getElementById("remarks").style.color = remarkColor;
  document.getElementById("grade-percentage").innerHTML = playerGrade;
  document.getElementById("wrong-answers").innerHTML = wrongAttempt;
  document.getElementById("right-answers").innerHTML = playerScore;
  document.getElementById("score-modal").style.display = "flex";
}

//closes score modal, resets game and reshuffles questions
function closeScoreModal() {
  questionNumber = 1;
  playerScore = 0;
  wrongAttempt = 0;
  indexNumber = 0;
  shuffledQuestions = [];
  NextQuestion(indexNumber);
  document.getElementById("score-modal").style.display = "none";
}

//function to close warning modal
function closeOptionModal() {
  document.getElementById("option-modal").style.display = "none";
}
